let lance = {
  user_name : 'lance@lance.com',
  password : '$2a$10$fa.V3LnXYMzXv23lOT8N0.5qfiZvh/DdrruGa.tLG0KRhJ1iWWan6',
  bits : [{
            joke_title : 'Facts getting faster',
            body : [
              { body : `This is the first body of bit 1`,
                created_at : '2018-01-01'
              },
              { body : `This is the second body of bit 1`,
                created_at : '2018-01-02'
              },
              { body : `This is the third body of bit 1`,
                created_at : '2018-01-03'
              }
            ],
            tags : [
              'Fact fury',
              'Brenner liked this',
              `Can't do this one in Oklahoma`
            ]
          },
          {
            joke_title : 'Forgetting how to type',
            body : [
              { body : `This is the first body of bit 2`,
                created_at : '2018-01-01'
              },
              { body : `This is the second body of bit 2`,
                created_at : '2018-01-02'
              }
            ],
            tags : [
              'Type',
              'Tag1'
            ]
          },
          {
            joke_title : 'Tech time',
            body : [
              { body : `This is the first body of bit 3`,
                created_at : '2018-01-01'
              }
            ],
            tags : []
          }],
  performances : [
    {
      per_title : 'Laugh Out Proud',
      location : 'Institution Theatre',
      given_time : 420,
      per_time : 400,
      audio : '/static/audio/test.mp3',
      rating : 4,
      date : '2018-01-01'
    },
    {
      per_title : 'Laugh Out Proud',
      location : 'Institution Theatre',
      given_time : 420,
      per_time : 415,
      audio : '/static/audio/test.mp3',
      rating : 2,
      date : '2018-12-05'
    },
    {
      per_title : 'Laugh Out Proud',
      location : 'Institution Theatre',
      given_time : 420,
      per_time : 435,
      audio : '/static/audio/test.mp3',
      rating : 4,
      date : '2017-12-01'
    }
  ]
};

let paige = {
  user_name : 'paige@paige.com',
  password : '$2a$10$tPGtiaeUMPb0Fco4XvMsMukW81T0dT4HVPkkp.s/HfZB9lAv4bZVy',
  bits : [{
            joke_title : 'Baseball canoe',
            body : [
              { body : `This is the first body of bit 1`,
                created_at : '2018-01-01'
              },
              { body : `This is the second body of bit 1`,
                created_at : '2018-01-01'
              },
              { body : `What is people played baseball in canoes? That would be crazy, right? I mean, the water is so wet, and baseball is SO DRY!`,
                created_at : '2018-01-01'
              }
            ],
            tags : [
              'Swing and a miss',
              'Boom goes the dynamite',
              `Sting every breath`,
              `We built this city on rock`,
              `Nobody knows but the best`,
              `Testing how long a tag can be because tags may get long if a comic is really analytical.`
            ]
          },
          {
            joke_title : 'Top five explosions of 2017',
            body : [
              { body : `This is the first body of bit 2`,
                created_at : '2018-01-01'
              },
              { body : `This is the second body of bit 2`,
                created_at : '2018-01-01'
              },
              { body : `I watch so many shows on The Smithsonian channel, and they always have these lists shows about really generic topics. Shows that are just "top 5 airplanes!" How can you rate the top 5 airplanes? Who is the judge of these top 5s? So here's my list of Top 5 Explosions!`,
                created_at : '2018-01-01'
              }
            ],
            tags : [
              `Yosemite's gonna go eventually!`,
              `Or how I bombed tonight!`
            ]
          },
          {
            joke_title : 'Restaurants are everywhere',
            body : [
              { body : `I was making this project for quarter 1, about finding restaurants. There are SO MANY!`,
                created_at : '2018-01-01'
              }
            ],
            tags : []
          },
          {
            joke_title : 'The story about that time I did that thing',
            body : [
              { body : `Telling a story, but never using any proper nouns. Everything is always as generic as possible.`,
                created_at : '2018-01-01'
              }
            ],
            tags : []
          },
          {
            joke_title : 'Facts getting faster',
            body : [
              { body : `This is the first body of bit 1`,
                created_at : '2018-01-01'
              },
              { body : `This is the second body of bit 1`,
                created_at : '2018-01-01'
              },
              { body : `Joke body?`,
                created_at : '2018-01-01'
              }
            ],
            tags : [
              'Fact fury',
              'Brenner liked this',
              `Can't do this one in Oklahoma`
            ]
          },
          {
            joke_title : 'Forgetting how to type',
            body : [
              { body : `This is the first body of bit 2`,
                created_at : '2018-01-01'
              },
              { body : `ouh;oenub;soruntbs;rgbnr;tjbnsr;tbjnrstb`,
                created_at : '2018-01-02'
              }
            ],
            tags : [
              'Typing is hard',
              `That's why Siri is the future!`
            ]
          },
          {
            joke_title : 'Tech bros',
            body : [
              { body : `SO. MANY. BROS.`,
                created_at : '2018-01-02'
              }
            ],
            tags : []
          },


        ],
  performances : [
    {
      per_title : 'Reordered Mic',
      location : 'Kick Butt Coffee',
      given_time : 300,
      per_time : 290,
      audio : '/static/audio/test.mp3',
      rating : 2,
      date : '2018-01-01'
    },
    {
      per_title : 'FPIA',
      location : 'Cap City Comedy Club',
      given_time : 300,
      per_time : 295,
      audio : '/static/audio/test.mp3',
      rating : 4,
      date : '2018-12-05'
    },
    {
      per_title : 'Stories from the Edge',
      location : 'Spiderhouse Ballroom',
      given_time : 900,
      per_time : 899,
      audio : '/static/audio/test.mp3',
      rating : 5,
      date : '2017-12-01'
    },
    {
      per_title : 'Coldtowne Open Mic',
      location : 'Coldtowne Theatre',
      given_time : 300,
      per_time : 280,
      audio : '/static/audio/test.mp3',
      rating : 4,
      date : '2017-10-01'
    },
    {
      per_title : 'Speed Mic',
      location : 'The Velv',
      given_time : 300,
      per_time : 290,
      audio : '/static/audio/test.mp3',
      rating : 4,
      date : '2017-11-01'
    },
    {
      per_title : 'Laugh Out Proud',
      location : 'Institution Theatre',
      given_time : 420,
      per_time : 400,
      audio : '/static/audio/test.mp3',
      rating : 4,
      date : '2018-01-01'
    },
    {
      per_title : 'Laugh Out Proud',
      location : 'Institution Theatre',
      given_time : 420,
      per_time : 415,
      audio : '/static/audio/test.mp3',
      rating : 2,
      date : '2018-12-05'
    },
    {
      per_title : 'Laugh Out Proud',
      location : 'Institution Theatre',
      given_time : 420,
      per_time : 435,
      audio : '/static/audio/test.mp3',
      rating : 4,
      date : '2017-12-01'
    }
  ]

};

exports.seed = function(knex, Promise) {
  // Deletes ALL existing entries
  return knex('jokes_labels').del()
    .then(() => {
      return knex('labels').del();
    })
    .then(() => {
      return knex('sessions').del();
    })
    .then(() => {
      return knex('jokes_performances').del();
    })
    .then(() => {
      return knex('joke_body').del();
    })
    .then(() => {
      return knex('tags').del();
    })
    .then(() => {
      return knex('performances').del();
    })
    .then(() => {
      return knex('jokes').del();
    })
    .then(() => {
      return knex('users').del();
    })
    .then(() => {
      return knex('users').returning('id').insert([
        { user_name : lance.user_name,
          password : lance.password }
      ]);
    })
    .then((userID1) => {
      lance.user_id = userID1[0];
      return knex('users').returning('id').insert([
        { user_name : paige.user_name,
          password : paige.password },
      ]);
    })
    .then((userID2) => {
      paige.user_id = userID2[0];
      console.log('lance.user_id - ', lance.user_id, ' || paige.user_id - ', paige.user_id );
      let labelsInsert = {
        'user_id' : lance.user_id,
        'label' : 'new'
      };
      return knex('labels').returning('label_id').insert(labelsInsert);
    })
    .then((labelID0)=>{
      lance.bits[0].label_id = labelID0[0];
      console.log('lance.bits[0].label_id - ', lance.bits[0].label_id);
      let labelsInsert = {
        'user_id' : lance.user_id,
        'label' : 'good'
      };
      return knex('labels').returning('label_id').insert(labelsInsert);
    })
    .then((labelID1)=>{
      lance.bits[1].label_id = labelID1[0];
      console.log('lance.bits[1].label_id - ', lance.bits[1].label_id);
      let labelsInsert = {
        'user_id' : lance.user_id,
        'label' : 'new'
      };
      return knex('labels').returning('label_id').insert(labelsInsert);
    })
    .then((labelID2)=>{
      let labelsInsert = {
        'user_id' : lance.user_id,
        'label' : 'closer'
      };
      return knex('labels').returning('label_id').insert(labelsInsert);
    })
    .then((labelID3)=>{
      let labelsInsert = {
        'user_id' : paige.user_id,
        'label' : 'new'
      };
      return knex('labels').returning('label_id').insert(labelsInsert);
    })
    .then((labelID4)=>{
      let labelsInsert = {
        'user_id' : paige.user_id,
        'label' : 'good'
      };
      return knex('labels').returning('label_id').insert(labelsInsert);
    })
    .then((labelID5)=>{
      paige.bits[1].label_id = labelID5[0];
      let labelsInsert = {
        'user_id' : paige.user_id,
        'label' : 'closer'
      };
      return knex('labels').insert(labelsInsert);
    })
    .then(() => {
      let jokeInsertArr = [];
      lance.bits.forEach((bit) => {
        if (bit.label_id) {
          jokeInsertArr.push({
            joke_title : bit.joke_title,
            label_id : bit.label_id,
            user_id : lance.user_id
          });
        } else {
          jokeInsertArr.push({
            joke_title : bit.joke_title,
            user_id : lance.user_id
          });
        }
      });
      paige.bits.forEach((bit) => {
        if (bit.label_id) {
          jokeInsertArr.push({
            joke_title : bit.joke_title,
            label_id : bit.label_id,
            user_id : paige.user_id
          });
        } else {
          jokeInsertArr.push({
            joke_title : bit.joke_title,
            user_id : paige.user_id
          });
        }
      });
      return knex('jokes').insert(jokeInsertArr);
    })
    .then(()=>{
      return knex('jokes').select('joke_title', 'joke_id');
    })
    .then((jokeInfoArr) => {
      console.log('The joke IDs - ', jokeInfoArr);
      let jokeBodyInsertArr = [];
      lance.bits.forEach((bit) => {
        jokeInfoArr.forEach((jokeObj)=>{
          if (jokeObj.joke_title === bit.joke_title) {
            bit.joke_id = jokeObj.joke_id;
          }
        });
        bit.body.forEach((bitBody) => {
          jokeBodyInsertArr.push({
            joke_id : bit.joke_id,
            body : bitBody.body,
            created_at : bitBody.created_at
          });
        });
      });
      paige.bits.forEach((bit) => {
        jokeInfoArr.forEach((jokeObj)=>{
          if (jokeObj.joke_title === bit.joke_title) {
            bit.joke_id = jokeObj.joke_id;
          }
        });
        bit.body.forEach((bitBody) => {
          jokeBodyInsertArr.push({
            joke_id : bit.joke_id,
            body : bitBody.body,
            created_at : bitBody.created_at
          });
        });
      });
      return knex('joke_body').insert(jokeBodyInsertArr);
    })
    .then(() => {
      let tagsInsertArr = [];
      lance.bits.forEach((bit) => {
        bit.tags.forEach((tag) => {
          tagsInsertArr.push({
            joke_id : bit.joke_id,
            tag : tag
          });
        });
      });
      paige.bits.forEach((bit) => {
        bit.tags.forEach((tag) => {
          console.log(`Paige's bit - `, bit.joke_title, 'and ID - ',bit.joke_id);
          tagsInsertArr.push({
            joke_id : bit.joke_id,
            tag : tag
          });
        });
      });
      return knex('tags').insert(tagsInsertArr);
    })
    .then(() => {
      let performanceInsertArr = [];
      lance.performances.forEach((perf) => {
        performanceInsertArr.push({
          per_title : perf.per_title,
          user_id : lance.user_id,
          location : perf.location,
          given_time : perf.given_time,
          per_time : perf.per_time,
          audio : perf.audio,
          rating : perf.rating,
          date : perf.date
        });
      });
      paige.performances.forEach((perf) => {
        performanceInsertArr.push({
          per_title : perf.per_title,
          user_id : paige.user_id,
          location : perf.location,
          given_time : perf.given_time,
          per_time : perf.per_time,
          audio : perf.audio,
          rating : perf.rating,
          date : perf.date
        });
      });
      return knex('performances').insert(performanceInsertArr);
    })
    .then(()=>{
      return knex('performances').select('per_id', 'per_title', 'per_time');
    })
    .then((performanceIDs) => {
      console.log('Performance IDs - ', performanceIDs);
      let performancesJokesInsertArr = [];
      lance.performances.forEach((perf) => {
        performanceIDs.forEach((performanceInDB)=>{
          if (perf.per_title === performanceInDB.per_title && perf.per_time === performanceInDB.per_time) {
            perf.per_id = performanceInDB.per_id;
          }
        });
        lance.bits.forEach((bit) => {
          performancesJokesInsertArr.push({
            joke_id : bit.joke_id,
            per_id : perf.per_id
          });
        });
      });
      paige.performances.forEach((perf) => {
        performanceIDs.forEach((performanceInDB)=>{
          if (perf.per_title === performanceInDB.per_title && perf.per_time === performanceInDB.per_time) {
            perf.per_id = performanceInDB.per_id;
          }
        });
        paige.bits.forEach((bit) => {
          performancesJokesInsertArr.push({
            joke_id : bit.joke_id,
            per_id : perf.per_id
          });
        });
      });
      console.log('The performances insert array - ', performancesJokesInsertArr);
      return knex('jokes_performances').insert(performancesJokesInsertArr);
    });
};
